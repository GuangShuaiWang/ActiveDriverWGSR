---
title: "ActiveDriverWGSR"
author: "Helen Zhu, Dr. Juri Reimand"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    toc: false
vignette: >
  %\VignetteIndexEntry{ActiveDriverWGSR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning=FALSE, 
                      message=FALSE, 
                      width=500)
options(max.print=35)
```

# Introduction

ActiveDriverWGS is a driver discovery tool for cancer whole genome sequencing data. It analyzes the mutational burden of SNVs and short INDELs in functionally defined regions of interest and returns regions which are significantly mutated compared to a background window. For more information, please refer to the ActiveDriverWGS preprint. https://www.biorxiv.org/content/early/2017/12/19/236802

### Please note 
ActiveDriverWGS is only currently available for GRCh37. We are working on adding the option for GRCh38.

# Input Data
ActiveDriverWGSR requires a file for somatic mutations and a file for genomic elements. A third optional file for sites within genomic elements (i.e. post-translational modification sites in protein coding genes) can be used to find genomic elements with enriched site mutations.

```{r input}
library(ActiveDriverWGSR)

data("breastcancer_mutations")
head(breastcancer_mutations)

data("coding_regions")
head(coding_regions)

data("post_translational_modification_sites")
head(post_translational_modification_sites)

```

# Basic Use


```{r ActiveDriverWGS}
# results = ActiveDriverWGS(mutations = breastcancer_mutations,
#                           elements = coding_regions,
#                           sites = post_translational_modification_sites) # an optional input parameter

```

## Parameter Interpretation
ActiveDriverWGS has several adjustable parameters:

1) Background window `window_size`

2) Filtering hypermutated samples `filter_hyper_MB`

3) Recovery directory `recovery.dir`

4) Multiple cores `mc.cores`

# Interpreting the Results
ActiveDriverWGSR will return a results file in a data frame format with the following columns.

1) `id`

2) `pp_element`

3) `element_muts_obs`

4) `element_muts_exp`

5) `element_enriched`

6) `pp_site`

7) `site_muts_obs`

8) `site_enriched`

9) `fdr_element`

10) `fdr_site`

```{r pressure, echo=FALSE}
# heaa(results)
```
